<script type="text/javascript">
    var gk_fileData = {};
    function loadFileData(filename) {
      return gk_fileData[filename] || "";
    }
    </script><!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta name="description" content="TaskFlow: Tareas con precisión absoluta.">
  <title>TaskFlow</title>
  <style>
    :root {
      --background-color: #FEFEFE;
      --card-background: rgba(255, 255, 255, 0.94);
      --text-primary: #0F172A;
      --text-secondary: #64748B;
      --accent-blue: #0066FF;
      --success-green: #22D3EE;
      --warning-yellow: #FCD34D;
      --danger-red: #FB7185;
      --secondary-gray: #A8A8A8;
      --shadow: 0 6px 14px rgba(0,0,0,0.07);
      --shadow-hover: 0 10px 22px rgba(0,0,0,0.09);
      --border-radius: 20px;
      --transition: all 0.2s cubic-bezier(0.2, 0, 0, 1);
    }

    [data-theme="dark"] {
      --background-color: #0A0E1A;
      --card-background: rgba(26, 35, 56, 0.94);
      --text-primary: #E6E8EB;
      --text-secondary: #8B95A6;
      --accent-blue: #4B6EFA;
      --success-green: #34C4D9;
      --warning-yellow: #E8B923;
      --danger-red: #F87171;
      --secondary-gray: #5B6478;
      --shadow: 0 6px 14px rgba(0,0,0,0.25);
      --shadow-hover: 0 10px 22px rgba(0,0,0,0.3);
    }

    * {
      box-sizing: border-box;
      margin: 0;
      padding: 0;
      transition: background-color 0.4s ease-in-out, color 0.4s ease-in-out, box-shadow 0.2s;
    }

    body {
      font-family: -apple-system, BlinkMacSystemFont, 'San Francisco', Roboto, sans-serif;
      max-width: 720px;
      margin: 0 auto;
      padding: 48px;
      background-color: var(--background-color);
      color: var(--text-primary);
      line-height: 1.65;
      letter-spacing: -0.02em;
      overflow-x: hidden;
    }

    .logo-container {
      display: flex;
      
      align-items: center;
      justify-content: center;
      margin-bottom: 24px;
    }

    .logo-image {
      margin-right: -35px;
      margin-bottom: -6px;
      width: 150px;
      height: 150px;
      object-fit: contain;
      transition: filter 0.9s ease-in-out;
      filter: invert(48%) sepia(99%) saturate(2476%) hue-rotate(210deg) brightness(100%) contrast(100%); /* Blue tint for light theme */
    }

    [data-theme="dark"] .logo-image {
      filter: invert(100%) /* Cyan tint for dark theme */
    }

    h1 {
  text-align: center;
  font-size: clamp(50px, 4vw, 28px);
  font-weight: 700;
  transition: background-color 0s linear !important; /* solo deja otras transiciones */
}


.toolbar {
  display: flex;
  justify-content: center;
  align-items: center;
  gap: 12px;
  flex-wrap: wrap;
  margin-bottom: 32px;
  padding-bottom: 16px;
  border-bottom: 0.5px solid rgba(229,231,235,0.5);
  width: 100%;
  max-width: 720px;
  margin-left: auto;
  margin-right: auto;
}


    [data-theme="dark"] .toolbar {
      border-bottom: 0.5px solid rgba(59,71,98,0.5);
    }

    .toolbar button {
      padding: 8px 14px;
      border: none;
      border-radius: 14px;
      cursor: pointer;
      font-size: 11px;
      font-weight: 600;
      transition: var(--transition);
      display: flex;
      align-items: center;
      gap: 6px;
      text-overflow: ellipsis;
      white-space: nowrap;
      max-width: 280px;
    }

    .toolbar .reset {
      background-color: transparent;
      color: var(--secondary-gray);
    }

    .toolbar .reset:hover {
      background-color: rgba(248,113,113,0.1);
      color: var(--danger-red);
      transform: scale(1.05);
    }

    .toolbar .low-stress {
      background-color: var(--accent-blue);
      color: #FFFFFF;
    }

    .toolbar .low-stress:hover {
      background-color: #0052CC;
      box-shadow: 0 0 8px rgba(0,102,255,0.3);
      transform: scale(1.05);
    }

    [data-theme="dark"] .toolbar .low-stress:hover {
      background-color: #3B5BDB;
      box-shadow: 0 0 8px rgba(75,110,250,0.3);
    }

    .toolbar .dark-mode {
      background-color: transparent;
      color: var(--secondary-gray);
    }

    .toolbar .dark-mode:hover {
      background-color: rgba(0,102,255,0.1);
      color: var(--accent-blue);
      transform: scale(1.05);
    }

    [data-theme="dark"] .toolbar .dark-mode:hover {
      background-color: rgba(75,110,250,0.1);
    }

    .task-form {
      background-color: var(--card-background);
      padding: 32px;
      border-radius: var(--border-radius);
      box-shadow: var(--shadow);
      margin-bottom: 24px;
      display: grid;
      grid-template-columns: 1fr;
      gap: 16px;
      align-items: end;
      backdrop-filter: blur(16px);
      border: 0.5px solid rgba(255,255,255,0.2);
      width: 100%;
    }

    .task-form-row {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
      gap: 16px;
      align-items: end;
    }

    .form-group {
      display: flex;
      flex-direction: column;
    }

    .form-group label {
      font-size: 12px;
      font-weight: 500;
      margin-bottom: 8px;
      color: var(--text-primary);
      position: relative;
      cursor: help;
    }

    .form-group label .tooltip-text {
      visibility: hidden;
      width: 140px;
      background-color: rgba(26,35,56,0.92);
      color: #FFFFFF;
      font-size: 12px;
      font-weight: 400;
      text-align: center;
      border-radius: 14px;
      padding: 8px;
      position: absolute;
      z-index: 1;
      top: 140%;
      left: 50%;
      transform: translateX(-50%) translateY(-6px);
      opacity: 0;
      transition: opacity 0.2s, transform 0.2s;
      backdrop-filter: blur(10px);
    }

    [data-theme="dark"] .form-group label .tooltip-text {
      background-color: rgba(255,255,255,0.92);
      color: #0F172A;
    }

    .form-group label:hover .tooltip-text {
      visibility: visible;
      opacity: 1;
      transform: translateX(-50%) translateY(0);
    }

/* INPUTS DE TEXTO Y SELECT */
.task-form input:not([type="date"],[type="time"]),
.task-form select {
  width: 100%;
  padding: 10px;
  border: none;
  border-radius: 14px;
  font-size: 14px;
  font-weight: 400;
  background-color: rgba(255, 255, 255, 0.95);
  color: var(--text-primary);
  transition: var(--transition);
  appearance: none;
  background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='16' height='16' viewBox='0 0 24 24' fill='none' stroke='%2364748B' stroke-width='2'%3E%3Cpath d='M6 9l6 6 6-6'/%3E%3C/svg%3E");
  background-repeat: no-repeat;
  background-position: right 10px center;
  background-size: 16px;
}

[data-theme="dark"] .task-form input:not([type="date"],[type="time"]),
[data-theme="dark"] .task-form select {
  background-color: rgba(26, 35, 56, 0.95);
  background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='16' height='16' viewBox='0 0 24 24' fill='none' stroke='%2364748B' stroke-width='2'%3E%3Cpath d='M6 9l6 6 6-6'/%3E%3C/svg%3E");
}

/* INPUT TIPO FECHA */
.task-form input[type="date"] {
  width: 100%;
  padding: 10px;
  border: none;
  border-radius: 14px;
  font-size: 14px;
  font-weight: 400;
  background-color: rgba(255, 255, 255, 0.95);
  color: var(--text-primary);
  transition: var(--transition);
  appearance: none;
  background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='16' height='16' viewBox='0 0 24 24' fill='none' stroke='%2364748B' stroke-width='2'%3E%3Cpath d='M6 2v2M18 2v2M3 7h18M5 7v14a2 2 0 002 2h10a2 2 0 002-2V7'/%3E%3C/svg%3E");
  background-repeat: no-repeat;
  background-position: right 10px center;
  background-size: 16px;
}

/* INPUT TIPO HORA */
.task-form input[type="time"] {
  width: 100%;
  padding: 10px;
  border: none;
  border-radius: 14px;
  font-size: 14px;
  font-weight: 400;
  background-color: rgba(255, 255, 255, 0.95);
  color: var(--text-primary);
  transition: var(--transition);
  appearance: none;
  background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='16' height='16' viewBox='0 0 24 24' fill='none' stroke='%2364748B' stroke-width='2'%3E%3Ccircle cx='12' cy='12' r='10'/%3E%3Cpath d='M12 6v6l4 2'/%3E%3C/svg%3E");
  background-repeat: no-repeat;
  background-position: right 10px center;
  background-size: 16px;
}

/* MODO OSCURO PARA FECHA Y HORA */
[data-theme="dark"] .task-form input[type="date"] {
  background-color: rgba(26, 35, 56, 0.95);
  background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='16' height='16' viewBox='0 0 24 24' fill='none' stroke='%2364748B' stroke-width='2'%3E%3Cpath d='M6 2v2M18 2v2M3 7h18M5 7v14a2 2 0 002 2h10a2 2 0 002-2V7'/%3E%3C/svg%3E");
}

[data-theme="dark"] .task-form input[type="time"] {
  background-color: rgba(26, 35, 56, 0.95);
  background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='16' height='16' viewBox='0 0 24 24' fill='none' stroke='%2364748B' stroke-width='2'%3E%3Ccircle cx='12' cy='12' r='10'/%3E%3Cpath d='M12 6v6l4 2'/%3E%3C/svg%3E");
}

/* ENFOQUE */
.task-form input:focus:not([type="date"],[type="time"]),
.task-form select:focus,
.task-form input[type="date"]:focus,
.task-form input[type="time"]:focus {
  outline: none;
  background-color: rgba(255, 255, 255, 1);
  box-shadow: 0 0 6px rgba(0, 102, 255, 0.25);
}

[data-theme="dark"] .task-form input:focus:not([type="date"],[type="time"]),
[data-theme="dark"] .task-form select:focus,
[data-theme="dark"] .task-form input[type="date"]:focus,
[data-theme="dark"] .task-form input[type="time"]:focus {
  background-color: rgba(51, 65, 85, 1);
  box-shadow: 0 0 6px rgba(75, 110, 250, 0.25);
}

/* ELIMINAR ÍCONOS NATIVOS DE LOS INPUTS */
input[type="date"]::-webkit-calendar-picker-indicator,
input[type="time"]::-webkit-calendar-picker-indicator {
  opacity: 0;
  display: none;
  -webkit-appearance: none;
}

input[type="date"],
input[type="time"] {
  -moz-appearance: textfield;
}


    .task-form input::placeholder {
      color: var(--text-secondary);
      font-weight: 400;
      opacity: 0.6;
    }

    .effort-bars {
      display: flex;
      gap: 6px;
      align-items: flex-end;
      justify-content: flex-start;

    }

    .effort-bar {
      width: 28px;
      border-radius: 4px;
      cursor: pointer;
      transition: opacity 0.2s, box-shadow 0.2s;
      opacity: 0.6;
    }

    .effort-bar.selected {
      opacity: 1;
      box-shadow: 0 0 6px rgba(0,0,0,0.2);
    }

    [data-theme="dark"] .effort-bar.selected {
      box-shadow: 0 0 6px rgba(255,255,255,0.2);
    }

    .effort-bar.level-1 { height: 10px; background-color: #22D3EE; }
    .effort-bar.level-2 { height: 14px; background-color: #34C4D9; }
    .effort-bar.level-3 { height: 18px; background-color: #FCD34D; }
    .effort-bar.level-4 { height: 22px; background-color: #FB7185; }
    .effort-bar.level-5 { height: 26px; background-color: #F87171; }

    .task-form button {
      padding: 12px 24px;
      background-color: var(--accent-blue);
      color: #FFFFFF;
      border: none;
      border-radius: 14px;
      cursor: pointer;
      font-size: 14px;
      font-weight: 600;
      transition: var(--transition);
      width: 100%;
      max-width: 200px;
      margin: 20px auto 0 auto;

    }

    .task-form button:hover {
      background-color: #0052CC;
      box-shadow: 0 0 8px rgba(0,102,255,0.3);
      transform: scale(1.05);
    }

    [data-theme="dark"] .task-form button:hover {
      background-color: #3B5BDB;
      box-shadow: 0 0 8px rgba(75,110,250,0.3);
    }

    .task-form button:active {
      transform: scale(0.95);
    }

    .mode-indicator {
      text-align: center;
      font-size: 13px;
      font-weight: 400;
      color: var(--text-secondary);
      margin-bottom: 32px;
      position: relative;
      cursor: help;
    }

    .mode-indicator .tooltip-text {
      visibility: hidden;
      width: 160px;
      background-color: rgba(26,35,56,0.92);
      color: #FFFFFF;
      font-size: 12px;
      font-weight: 400;
      text-align: center;
      border-radius: 14px;
      padding: 8px;
      position: absolute;
      z-index: 1;
      top: 140%;
      left: 50%;
      transform: translateX(-50%) translateY(-6px);
      opacity: 0;
      transition: opacity 0.2s, transform 0.2s;
      backdrop-filter: blur(10px);
    }

    [data-theme="dark"] .mode-indicator .tooltip-text {
      background-color: rgba(255,255,255,0.92);
      color: #0F172A;
    }

    .mode-indicator:hover .tooltip-text {
      visibility: visible;
      opacity: 1;
      transform: translateX(-50%) translateY(0);
    }

    .task-list {
      list-style: none;
      padding: 0;
    }

    .task-item {
      display: flex;
      align-items: center;
      padding: 20px;
      margin-bottom: 28px;
      border-radius: var(--border-radius);
      background-color: var(--card-background);
      box-shadow: var(--shadow);
      border: 0.5px solid rgba(255,255,255,0.2);
      transition: var(--transition);
      animation: springIn 0.4s cubic-bezier(0.2, 0, 0, 1.2);
      backdrop-filter: blur(16px);
    }

    .task-item:hover {
      box-shadow: var(--shadow-hover);
      transform: translateY(-4px);
    }

    .task-item.low { border-left: 4px solid var(--success-green); }
    .task-item.medium { border-left: 4px solid var(--warning-yellow); }
    .task-item.high { border-left: 4px solid var(--danger-red); }
    .task-item.completed {
      opacity: 0.8;
      background-color: rgba(255, 255, 255, 0.9);
    }

    [data-theme="dark"] .task-item.completed {
      background-color: rgba(26, 35, 56, 0.9);
    }

    .task-item .task-checkbox {
      margin-right: 16px;
      width: 20px;
      height: 20px;
      border-radius: 50%;
      border: 1.5px solid var(--text-secondary);
      appearance: none;
      cursor: pointer;
      transition: var(--transition);
    }

    .task-item .task-checkbox:checked {
      background-color: var(--accent-blue);
      border-color: var(--accent-blue);
      background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24' fill='white'%3E%3Cpath d='M9 16.2l-3.5-3.5L4 14.1l5 5 10-10-1.4-1.4L9 16.2z'/%3E%3C/svg%3E");
      background-size: 14px;
      background-position: center;
      background-repeat: no-repeat;
      transform: scale(1.15);
      animation: checkPop 0.2s ease-out;
    }

    .task-item .task-details {
      flex: 1;
    }

    .task-item .task-details strong {
      font-size: 15px;
      font-weight: 500;
      display: block;
      margin-bottom: 6px;
    }

    .task-item .task-details.completed strong {
      text-decoration: line-through;
    }

    .task-item .task-details span {
      font-size: 13px;
      font-weight: 400;
      color: var(--text-secondary);
    }

    .task-item .task-actions button {
      padding: 8px 18px;
      margin-left: 14px;
      border: none;
      border-radius: 14px;
      cursor: pointer;
      font-size: 14px;
      font-weight: 600;
      transition: var(--transition);
    }

    .task-item button.edit {
      background-color: transparent;
      color: var(--accent-blue);
    }

    .task-item button.edit:hover {
      background-color: rgba(0,102,255,0.1);
      transform: scale(1.05);
    }

    [data-theme="dark"] .task-item button.edit:hover {
      background-color: rgba(75,110,250,0.1);
    }

    .task-item button.delete {
      background-color: transparent;
      color: var(--danger-red);
    }

    .task-item button.delete:hover {
      background-color: rgba(248,113,113,0.1);
      transform: scale(1.05);
    }

    .error-message {
      grid-column: 1 / -1;
      color: var(--danger-red);
      font-size: 13px;
      text-align: center;
      display: none;
      margin-top: 12px;
      font-weight: 400;
      animation: fadeIn 0.3s ease-out;
    }

    .empty-state {
      text-align: center;
      padding: 28px;
      font-size: 15px;
      font-weight: 400;
      color: var(--text-secondary);
      background-color: var(--card-background);
      border-radius: var(--border-radius);
      box-shadow: var(--shadow);
      backdrop-filter: blur(16px);
      border: 0.5px solid rgba(255,255,255,0.2);
    }

    .low-stress-note {
      font-size: 13px;
      font-weight: 400;
      color: var(--text-primary);
      text-align: center;
      margin-bottom: 32px;
      display: none;
      background-color: rgba(52,196,217,0.1);
      padding: 12px;
      border-radius: 14px;
      border: 0.5px solid rgba(52,196,217,0.2);
    }

    [data-theme="dark"] .low-stress-note {
      background-color: rgba(52,196,217,0.15);
      border: 0.5px solid rgba(52,196,217,0.3);
    }

    .modal {
      display: none;
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background-color: rgba(0,0,0,0.1);
      backdrop-filter: blur(12px);
      z-index: 1000;
      align-items: center;
      justify-content: center;
      animation: fadeInModal 0.25s cubic-bezier(0.2, 0, 0, 1);
    }

    [data-theme="dark"] .modal {
      background-color: rgba(0,0,0,0.4);
    }

    .modal-content {
      background-color: var(--card-background);
      padding: 24px;
      border-radius: var(--border-radius);
      box-shadow: var(--shadow);
      border: 0.5px solid rgba(255,255,255,0.2);
      width: 90%;
      max-width: 360px;
      backdrop-filter: blur(16px);
      animation: zoomIn 0.25s cubic-bezier(0.2, 0, 0, 1) forwards;
    }

    .modal-content h2 {
      font-size: 17px;
      font-weight: 700;
      margin-bottom: 24px;
      color: var(--text-primary);
    }

    .modal-content .form-group {
      margin-bottom: 24px;
    }

    .modal-content label {
      display: block;
      font-size: 11px;
      font-weight: 500;
      margin-bottom: 8px;
      color: var(--text-primary);
      position: relative;
      cursor: help;
    }

    .modal-content label .tooltip-text {
      visibility: hidden;
      width: 140px;
      background-color: rgba(26,35,56,0.92);
      color: #FFFFFF;
      font-size: 12px;
      font-weight: 400;
      text-align: center;
      border-radius: 14px;
      padding: 8px;
      position: absolute;
      z-index: 1;
      top: 140%;
      left: 50%;
      transform: translateX(-50%) translateY(-6px);
      opacity: 0;
      transition: opacity 0.2s, transform 0.2s;
      backdrop-filter: blur(10px);
    }

    [data-theme="dark"] .modal-content label .tooltip-text {
      background-color: rgba(255,255,255,0.92);
      color: #0F172A;
    }

    .modal-content label:hover .tooltip-text {
      visibility: visible;
      opacity: 1;
      transform: translateX(-50%) translateY(0);
    }

    .modal-content input:not([type="date"],[type="time"]), .modal-content select {
      width: 100%;
      padding: 8px;
      border: none;
      border-radius: 14px;
      font-size: 13px;
      font-weight: 400;
      background-color: rgba(255, 255, 255, 0.95);
      color: var(--text-primary);
      background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='16' height='16' viewBox='0 0 24 24' fill='none' stroke='%2364748B' stroke-width='2'%3E%3Cpath d='M6 9l6 6 6-6'/%3E%3C/svg%3E");
      background-repeat: no-repeat;
      background-position: right 8px center;
      background-size: 16px;
      appearance: none;
    }

    [data-theme="dark"] .modal-content input:not([type="date"],[type="time"]), [data-theme="dark"] .modal-content select {
      background-color: rgba(26, 35, 56, 0.95);
      background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='16' height='16' viewBox='0 0 24 24' fill='none' stroke='%238B95A6' stroke-width='2'%3E%3Cpath d='M6 9l6 6 6-6'/%3E%3C/svg%3E");
    }

    .modal-content input[type="date"], .modal-content input[type="time"] {
      width: 100%;
      padding: 8px;
      border: none;
      border-radius: 14px;
      font-size: 13px;
      font-weight: 400;
      background-color: rgba(255, 255, 255, 0.95);
      color: var(--text-primary);
      background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='16' height='16' viewBox='0 0 24 24' fill='none' stroke='%2364748B' stroke-width='2'%3E%3Cpath d='M6 2v2M18 2v2M3 7h18M5 7V21a2 2 0 002 2h10a2 2 0 002-2V7M10 11h4v4h-4z'/%3E%3C/svg%3E");
      background-repeat: no-repeat;
      background-position: right 8px center;
      background-size: 16px;
      appearance: none;
    }

    [data-theme="dark"] .modal-content input[type="date"], [data-theme="dark"] .modal-content input[type="time"] {
      background-color: rgba(26, 35, 56, 0.95);
      background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='16' height='16' viewBox='0 0 24 24' fill='none' stroke='%238B95A6' stroke-width='2'%3E%3Cpath d='M6 2v2M18 2v2M3 7h18M5 7V21a2 2 0 002 2h10a2 2 0 002-2V7M10 11h4v4h-4z'/%3E%3C/svg%3E");
    }

    .modal-content .buttons {
      display: flex;
      justify-content: flex-end;
      gap: 14px;
      margin-top: 24px;
    }

    .modal-content button {
      padding: 8px 22px;
      border: none;
      border-radius: 14px;
      cursor: pointer;
      font-size: 13px;
      font-weight: 600;
    }

    .modal-content .save {
      background-color: var(--accent-blue);
      color: #FFFFFF;
    }

    .modal-content .save:hover {
      background-color: #0052CC;
      box-shadow: 0 0 8px rgba(0,102,255,0.3);
    }

    [data-theme="dark"] .modal-content .save:hover {
      background-color: #3B5BDB;
      box-shadow: 0 0 8px rgba(75,110,250,0.3);
    }

    .modal-content .cancel {
      background-color: transparent;
      color: var(--secondary-gray);
    }

    .modal-content .cancel:hover {
      background-color: rgba(168,168,168,0.1);
    }

    [data-theme="dark"] .modal-content .cancel:hover {
      background-color: rgba(91,100,120,0.1);
    }

    @keyframes springIn {
      0% { opacity: 0; transform: translateY(20px); }
      50% { opacity: 1; transform: translateY(-4px); }
      100% { opacity: 1; transform: translateY(0); }
    }

    @keyframes fadeInModal {
      from { opacity: 0; }
      to { opacity: 1; }
    }

    @keyframes zoomIn {
      from { transform: scale(0.85); opacity: 0; }
      to { transform: scale(1); opacity: 1; }
    }

    @keyframes checkPop {
      0% { transform: scale(0.8); }
      50% { transform: scale(1.3); }
      100% { transform: scale(1.15); }
    }

    @keyframes fadeIn {
      from { opacity: 0; }
      to { opacity: 1; }
    }

    @keyframes shake {
      0%, 100% { transform: translateX(0); }
      25% { transform: translateX(-2px); }
      75% { transform: translateX(2px); }
    }

    .invalid {
      animation: shake 0.3s ease-in-out;
      box-shadow: 0 0 6px rgba(248,113,113,0.5);
    }

    @media (prefers-reduced-motion: reduce) {
      .task-item, .modal, .modal-content, button, .task-checkbox, .error-message, .invalid {
        animation: none;
        transition: none;
      }
    }

    @media (max-width: 768px) {
      .task-form-row {
        grid-template-columns: 1fr;
      }

      .toolbar {
        flex-direction: column;
        align-items: center;
      }

      .toolbar button {
        width: 100%;
        max-width: 220px;
      }

      .task-item {
        flex-direction: column;
        align-items: flex-start;
        gap: 20px;
      }

      .task-item .task-actions {
        width: 100%;
        display: flex;
        justify-content: flex-end;
      }

      .effort-bars {
        gap: 4px;
      }
    }

    @media (max-width: 480px) {

      h1 {
        font-size: 35px !important;
        margin-left: -25px;
  }

  .toolbar {
    gap: 16px;
    padding-bottom: 20px;
  }

  .toolbar button {
    font-size: 14px;
    padding: 12px 18px;
    max-width: 100%;
    border-radius: 18px;
  }

  .toolbar svg {
    width: 16px;
    height: 16px;
  }
      body { padding: 28px; }
      .task-form { padding: 24px; gap: 12px; }
      .task-form input:not([type="date"],[type="time"]), .task-form select, .task-form input[type="date"], .task-form input[type="time"] { padding: 10px; height: 48px; font-size: 13px; }
      .task-form button { padding: 10px 20px; font-size: 13px; height: 48px; max-width: 160px; }
      .task-item { padding: 16px; }
      .modal-content { padding: 20px; max-width: 300px; }
      .task-item .task-details strong { font-size: 14px; }
      .task-item .task-details span { font-size: 12px; }
      .toolbar button { padding: 8px 14px; font-size: 11px; }
      .logo-image { width: 48px; height: 48px; }
      .effort-bar { width: 24px; }
      .effort-bar.level-1 { height: 8px; }
      .effort-bar.level-2 { height: 12px; }
      .effort-bar.level-3 { height: 16px; }
      .effort-bar.level-4 { height: 20px; }
      .effort-bar.level-5 { height: 24px; }

      .logo-container {
    display: flex;
    align-items: center;
    margin-left: -45px:
    gap: 4px;


  }

  .logo-image {
    width: 100px;
    height: 100px;
    margin: 0;
    margin-left: -25px;
    margin-bottom: -6px;
  }


        }    
  </style>
</head>
<body>
  <div class="logo-container">
    <img src="TASKFLOW.png" alt="TaskFlow Logo" class="logo-image">
    <h1>TaskFlow.</h1>
  </div>
  <div class="toolbar">
    <button class="reset" onclick="resetTasks()" aria-label="Reiniciar tareas">
      <svg width="12" height="12" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
        <path d="M3 6h18M5 6v14a2 2 0 002 2h10a2 2 0 002-2V6m-6 0V4a2 2 0 012-2h2a2 2 0 012 2v2"/>
      </svg>
      Reiniciar
    </button>
    <button class="low-stress" id="lowStressButton" onclick="toggleLowStressMode()" aria-label="Alternar modo bajo estrés">
      <svg width="12" height="12" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
        <path d="M12 2a10 10 0 100 20 10 10 0 000-20zm0 18a8 8 0 110-16 8 8 0 010 16z"/>
        <path d="M12 6v6l4 2"/>
      </svg>
      Bajo Estrés
    </button>
    <button class="dark-mode" id="darkModeButton" onclick="toggleDarkMode()" aria-label="Alternar modo oscuro">
      <svg width="12" height="12" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" class="dark-icon">
        <path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/>
      </svg>
      <svg width="12" height="12" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" class="light-icon" style="display: none;">
        <circle cx="12" cy="12" r="5"/>
        <path d="M12 1v2M12 21v2M4.22 4.22l1.42 1.42M18.36 18.36l1.42 1.42M1 12h2M21 12h2M4.22 19.78l1.42-1.42M18.36 5.64l1.42-1.42"/>
      </svg>
      Oscuro
    </button>
  </div>
  <div class="task-form">
    <div class="task-form-row">
      <div class="form-group">
        <label for="taskName">
          Tarea
          <span class="tooltip-text">Nombre descriptivo de la tarea, máx. 100 caracteres</span>
        </label>
        <input type="text" id="taskName" placeholder="Escribe tu tarea" maxlength="100" required aria-label="Nombre de la tarea">
      </div>
    </div>
    <div class="task-form-row">
      <div class="form-group">
        <label for="taskDeadline">
          Fecha límite
          <span class="tooltip-text">Fecha límite para completar la tarea</span>
        </label>
        <input type="date" id="taskDeadline" required aria-label="Fecha límite">
      </div>
      <div class="form-group">
        <label for="taskTime">
          Hora
          <span class="tooltip-text">Hora límite para completar la tarea</span>
        </label>
        <input type="time" id="taskTime" required aria-label="Hora límite">
      </div>
    </div>
    <div class="task-form-row">
      <div class="form-group">
        <label for="taskHours">
          Horas
          <span class="tooltip-text">Tiempo estimado en horas, de 1 a 24</span>
        </label>
        <select id="taskHours" required aria-label="Horas requeridas">
          <!-- Opciones generadas dinámicamente -->
        </select>
      </div>
      <div class="form-group">
        <label for="taskEffort">
          Esfuerzo
          <span class="tooltip-text">Nivel de esfuerzo: 1 es muy fácil, 5 es muy difícil</span>
        </label>
        <div class="effort-bars" id="taskEffortBars">
          <div class="effort-bar level-1" data-value="1"></div>
          <div class="effort-bar level-2" data-value="2"></div>
          <div class="effort-bar level-3" data-value="3"></div>
          <div class="effort-bar level-4" data-value="4"></div>
          <div class="effort-bar level-5" data-value="5"></div>
        </div>
        <input type="hidden" id="taskEffort" value="1">
      </div>
    </div>
    <div class="task-form-row">
      <div class="form-group">
        <button onclick="addTask()" aria-label="Añadir tarea">Añadir</button>
      </div>
    </div>
    <div class="error-message" id="errorMessage" role="alert"></div>
  </div>
  <div class="mode-indicator" id="modeIndicator">
    Normal
    <span class="tooltip-text">
      Normal: Todas las tareas, ordenadas por prioridad.<br>
      Bajo Estrés: Solo tareas de hoy, menos si superan 4h.
    </span>
  </div>
  <div class="low-stress-note" id="lowStressNote">
    Bajo Estrés: Tareas de hoy, priorizando las más ligeras si exceden 4h.
  </div>
  <ul class="task-list" id="taskList" role="list"></ul>

  <div class="modal" id="editModal">
    <div class="modal-content">
      <h2>Editar</h2>
      <div class="form-group">
        <label for="editTaskName">
          Tarea
          <span class="tooltip-text">Nombre descriptivo de la tarea, máx. 100 caracteres</span>
        </label>
        <input type="text" id="editTaskName" maxlength="100" required>
      </div>
      <div class="form-group">
        <label for="editTaskDeadline">
          Fecha límite
          <span class="tooltip-text">Fecha límite para completar la tarea</span>
        </label>
        <input type="date" id="editTaskDeadline" required>
      </div>
      <div class="form-group">
        <label for="editTaskTime">
          Hora
          <span class="tooltip-text">Hora límite para completar la tarea</span>
        </label>
        <input type="time" id="editTaskTime" required>
      </div>
      <div class="form-group">
        <label for="editTaskHours">
          Horas
          <span class="tooltip-text">Tiempo estimado en horas, de 1 a 24</span>
        </label>
        <select id="editTaskHours" required>
          <!-- Opciones generadas dinámicamente -->
        </select>
      </div>
      <div class="form-group">
        <label for="editTaskEffort">
          Esfuerzo
          <span class="tooltip-text">Nivel de esfuerzo: 1 es muy fácil, 5 es muy difícil</span>
        </label>
        <div class="effort-bars" id="editTaskEffortBars">
          <div class="effort-bar level-1" data-value="1"></div>
          <div class="effort-bar level-2" data-value="2"></div>
          <div class="effort-bar level-3" data-value="3"></div>
          <div class="effort-bar level-4" data-value="4"></div>
          <div class="effort-bar level-5" data-value="5"></div>
        </div>
        <input type="hidden" id="editTaskEffort" value="1">
      </div>
      <div class="buttons">
        <button class="cancel" onclick="closeEditModal()">Cancelar</button>
        <button class="save" onclick="saveEditedTask()">Guardar</button>
      </div>
    </div>
  </div>

  <script>
    var gk_fileData = {};
    function loadFileData(filename) {
      return gk_fileData[filename] || "";
    }

    let isLowStressMode = JSON.parse(localStorage.getItem("lowStressMode")) || false;
    let isDarkMode = JSON.parse(localStorage.getItem("darkMode")) || window.matchMedia("(prefers-color-scheme: dark)").matches;
    let editingTaskId = null;

    function populateHoursSelects() {
      const taskHoursSelect = document.getElementById("taskHours");
      const editTaskHoursSelect = document.getElementById("editTaskHours");
      
      const options = Array.from({ length: 24 }, (_, i) => {
        const value = i + 1;
        return `<option value="${value}">${value} hora${value > 1 ? "s" : ""}</option>`;
      }).join('');

      taskHoursSelect.innerHTML = options;
      editTaskHoursSelect.innerHTML = options;
    }

    function applyTheme() {
      document.documentElement.setAttribute("data-theme", isDarkMode ? "dark" : "light");
      document.getElementById("darkModeButton").innerHTML = `
        <svg width="12" height="12" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" class="dark-icon" style="display: ${isDarkMode ? "none" : "inline"};">
          <path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/>
        </svg>
        <svg width="12" height="12" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" class="light-icon" style="display: ${isDarkMode ? "inline" : "none"};">
          <circle cx="12" cy="12" r="5"/>
          <path d="M12 1v2M12 21v2M4.22 4.22l1.42 1.42M18.36 18.36l1.42 1.42M1 12h2M21 12h2M4.22 19.78l1.42-1.42M18.36 5.64l1.42-1.42"/>
        </svg>
        ${isDarkMode ? "Claro" : "Oscuro"}
      `;
    }

    function toggleDarkMode() {
      if (!window.matchMedia("(prefers-reduced-motion: reduce)").matches) {
        navigator.vibrate && navigator.vibrate(30);
      }
      isDarkMode = !isDarkMode;
      localStorage.setItem("darkMode", JSON.stringify(isDarkMode));
      applyTheme();
    }

    function sanitizeInput(input) {
      const div = document.createElement("div");
      div.textContent = input;
      return div.innerHTML;
    }

    function isValidName(name) {
      return name && name.trim().length > 0 && name.trim().length <= 100;
    }

    function isValidDateTime(dateStr, timeStr) {
      const date = new Date(dateStr + 'T' + (timeStr || '00:00'));
      const now = new Date();
      return date instanceof Date && !isNaN(date) && date >= now;
    }

    function isValidHours(hours) {
      const parsedHours = parseInt(hours, 10);
      return !isNaN(parsedHours) && parsedHours >= 1 && parsedHours <= 24;
    }

    function isValidEffort(effort) {
      return !isNaN(effort) && effort >= 1 && effort <= 5;
    }

    function calculatePriority(deadline, time, hours, effort) {
      const now = new Date();
      const dueDate = new Date(deadline + 'T' + time);
      const hoursRemaining = Math.max(0, (dueDate - now) / (1000 * 60 * 60));
      return (24 - hoursRemaining) * (hours * effort / 5);
    }

    function showError(message, elementId) {
      const errorDiv = document.getElementById("errorMessage");
      errorDiv.textContent = message;
      errorDiv.style.display = "block";
      if (elementId) {
        const element = document.getElementById(elementId);
        element.classList.add("invalid");
        element.setAttribute("aria-invalid", "true");
        setTimeout(() => {
          element.classList.remove("invalid");
          element.removeAttribute("aria-invalid");
        }, 300);
      }
      setTimeout(() => errorDiv.style.display = "none", 2500);
    }

    function setupEffortBars(containerId, inputId, initialValue) {
      const bars = document.querySelectorAll(`#${containerId} .effort-bar`);
      const input = document.getElementById(inputId);
      input.value = initialValue || "1";

      bars.forEach(bar => {
        bar.classList.toggle("selected", bar.dataset.value === input.value);
        bar.addEventListener("click", () => {
          bars.forEach(b => b.classList.remove("selected"));
          bar.classList.add("selected");
          input.value = bar.dataset.value;
        });
      });
    }

    function addTask() {
      const name = sanitizeInput(document.getElementById("taskName").value.trim());
      const deadline = document.getElementById("taskDeadline").value;
      const time = document.getElementById("taskTime").value;
      const hoursInput = document.getElementById("taskHours");
      const effortInput = document.getElementById("taskEffort");
      const hours = parseInt(hoursInput.value, 10) || 1;
      const effort = parseInt(effortInput.value, 10) || 1;

      if (!isValidName(name)) {
        showError("Ingresa un nombre válido.", "taskName");
        return;
      }
      if (!isValidDateTime(deadline, time)) {
        showError("Selecciona una fecha y hora futuras.", "taskDeadline");
        return;
      }
      if (!isValidHours(hours)) {
        showError("Selecciona horas válidas.", "taskHours");
        hoursInput.value = "1";
        return;
      }
      if (!isValidEffort(effort)) {
        showError("Selecciona un esfuerzo válido.", "taskEffort");
        effortInput.value = "1";
        setupEffortBars("taskEffortBars", "taskEffort", "1");
        return;
      }

      const task = {
        id: Date.now().toString(),
        name,
        deadline,
        time,
        hours,
        effort,
        priority: calculatePriority(deadline, time, hours, effort),
        completed: false
      };

      let tasks = JSON.parse(localStorage.getItem("tasks")) || [];
      tasks.push(task);
      localStorage.setItem("tasks", JSON.stringify(tasks));

      document.getElementById("taskName").value = "";
      document.getElementById("taskDeadline").value = "";
      document.getElementById("taskTime").value = "";
      hoursInput.value = "1";
      effortInput.value = "1";
      setupEffortBars("taskEffortBars", "taskEffort", "1");

      if (!window.matchMedia("(prefers-reduced-motion: reduce)").matches) {
        navigator.vibrate && navigator.vibrate([100, 50, 100]);
      }

      renderTasks();
    }

    function editTask(id) {
      let tasks = JSON.parse(localStorage.getItem("tasks")) || [];
      const task = tasks.find(t => t.id === id);
      if (!task) {
        showError("Tarea no encontrada.");
        return;
      }

      editingTaskId = id;
      document.getElementById("editTaskName").value = task.name;
      document.getElementById("editTaskDeadline").value = task.deadline;
      document.getElementById("editTaskTime").value = task.time || "";
      document.getElementById("editTaskHours").value = task.hours;
      document.getElementById("editTaskEffort").value = task.effort;
      setupEffortBars("editTaskEffortBars", "editTaskEffort", task.effort);
      document.getElementById("editModal").style.display = "flex";
    }

    function saveEditedTask() {
      const name = sanitizeInput(document.getElementById("editTaskName").value.trim());
      const deadline = document.getElementById("editTaskDeadline").value;
      const time = document.getElementById("editTaskTime").value;
      const hoursInput = document.getElementById("editTaskHours");
      const effortInput = document.getElementById("editTaskEffort");
      const hours = parseInt(hoursInput.value, 10) || 1;
      const effort = parseInt(effortInput.value, 10) || 1;

      if (!isValidName(name)) {
        showError("Ingresa un nombre válido.", "editTaskName");
        return;
      }
      if (!isValidDateTime(deadline, time)) {
        showError("Selecciona una fecha y hora futuras.", "editTaskDeadline");
        return;
      }
      if (!isValidHours(hours)) {
        showError("Selecciona horas válidas.", "editTaskHours");
        hoursInput.value = "1";
        return;
      }
      if (!isValidEffort(effort)) {
        showError("Selecciona un esfuerzo válido.", "editTaskEffort");
        effortInput.value = "1";
        setupEffortBars("editTaskEffortBars", "editTaskEffort", "1");
        return;
      }

      let tasks = JSON.parse(localStorage.getItem("tasks")) || [];
      const taskIndex = tasks.findIndex(t => t.id === editingTaskId);
      if (taskIndex === -1) {
        showError("Tarea no encontrada.");
        return;
      }

      tasks[taskIndex] = {
        ...tasks[taskIndex],
        name,
        deadline,
        time,
        hours,
        effort,
        priority: calculatePriority(deadline, time, hours, effort)
      };

      localStorage.setItem("tasks", JSON.stringify(tasks));
      if (!window.matchMedia("(prefers-reduced-motion: reduce)").matches) {
        navigator.vibrate && navigator.vibrate(80);
      }
      closeEditModal();
      renderTasks();
    }

    function closeEditModal() {
      document.getElementById("editModal").style.display = "none";
      editingTaskId = null;
    }

    function deleteTask(id) {
      if (!confirm("¿Eliminar esta tarea?")) return;

      let tasks = JSON.parse(localStorage.getItem("tasks")) || [];
      const initialLength = tasks.length;
      tasks = tasks.filter(t => t.id !== id);

      if (tasks.length === initialLength) {
        showError("Tarea no encontrada.");
        return;
      }

      localStorage.setItem("tasks", JSON.stringify(tasks));
      if (!window.matchMedia("(prefers-reduced-motion: reduce)").matches) {
        navigator.vibrate && navigator.vibrate(200);
      }
      setTimeout(renderTasks, 0);
    }

    function toggleTaskCompletion(id) {
      let tasks = JSON.parse(localStorage.getItem("tasks")) || [];
      const taskIndex = tasks.findIndex(t => t.id === id);
      if (taskIndex === -1) {
        showError("Tarea no encontrada.");
        return;
      }

      tasks[taskIndex].completed = !tasks[taskIndex].completed;
      localStorage.setItem("tasks", JSON.stringify(tasks));
      if (!window.matchMedia("(prefers-reduced-motion: reduce)").matches) {
        navigator.vibrate && navigator.vibrate(50);
      }
      renderTasks();
    }

    function resetTasks() {
      if (!confirm("¿Eliminar todas las tareas?")) return;

      localStorage.removeItem("tasks");
      if (!window.matchMedia("(prefers-reduced-motion: reduce)").matches) {
        navigator.vibrate && navigator.vibrate(200);
      }
      renderTasks();
    }

    function toggleLowStressMode() {
      isLowStressMode = !isLowStressMode;
      localStorage.setItem("lowStressMode", JSON.stringify(isLowStressMode));
      document.getElementById("lowStressButton").innerHTML = `
        <svg width="12" height="12" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
          <path d="M12 2a10 10 0 100 20 10 10 0 000-20zm0 18a8 8 0 110-16 8 8 0 010 16z"/>
          <path d="M12 6v6l4 2"/>
        </svg>
        ${isLowStressMode ? "Normal" : "Bajo Estrés"}
      `;
      document.getElementById("modeIndicator").textContent = isLowStressMode ? "Bajo Estrés" : "Normal";
      document.getElementById("lowStressNote").style.display = isLowStressMode ? "block" : "none";
      renderTasks();
    }

    function renderTasks() {
      const taskList = document.getElementById("taskList");
      let tasks = JSON.parse(localStorage.getItem("tasks")) || [];

      if (isLowStressMode) {
        const today = new Date();
        today.setHours(0, 0, 0, 0);
        tasks = tasks.filter(task => {
          const dueDate = new Date(task.deadline);
          return dueDate.toDateString() === today.toDateString() && !task.completed;
        });

        let totalHours = tasks.reduce((sum, task) => sum + task.hours, 0);
        if (totalHours > 4) {
          tasks.sort((a, b) => a.effort - b.effort);
          let accumulatedHours = 0;
          tasks = tasks.filter(task => {
            accumulatedHours += task.hours;
            return accumulatedHours <= 4;
          });
        }
      }

      tasks.sort((a, b) => {
        if (a.completed !== b.completed) return a.completed ? 1 : -1;
        return b.priority - a.priority;
      });

      if (tasks.length === 0) {
        taskList.innerHTML = '<li class="empty-state">Sin tareas pendientes.</li>';
        return;
      }

      taskList.innerHTML = tasks.map(task => {
        const effortLevel = task.effort <= 2 ? "low" : task.effort <= 4 ? "medium" : "high";
        const timeDisplay = task.time ? ` a las ${task.time}` : "";
        return `
          <li class="task-item ${effortLevel} ${task.completed ? "completed" : ""}">
            <input type="checkbox" class="task-checkbox" ${task.completed ? "checked" : ""} onclick="toggleTaskCompletion('${task.id}')" aria-label="Marcar tarea como completada">
            <div class="task-details ${task.completed ? "completed" : ""}">
              <strong>${task.name}</strong>
              <span>${new Date(task.deadline).toLocaleDateString('es-ES', { day: '2-digit', month: '2-digit', year: 'numeric' })}${timeDisplay} [${task.hours}h] Esfuerzo ${task.effort}</span>
            </div>
            <div class="task-actions">
              <button class="edit" onclick="editTask('${task.id}')" aria-label="Editar tarea">Editar</button>
              <button class="delete" onclick="deleteTask('${task.id}')" aria-label="Eliminar tarea">Eliminar</button>
            </div>
          </li>
        `;
      }).join('');
    }

    document.addEventListener("DOMContentLoaded", () => {
      applyTheme();
      populateHoursSelects();
      setupEffortBars("taskEffortBars", "taskEffort", "1");
      setupEffortBars("editTaskEffortBars", "editTaskEffort", "1");

      if (isLowStressMode) {
        document.getElementById("lowStressButton").innerHTML = `
          <svg width="12" height="12" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <path d="M12 2a10 10 0 100 20 10 10 0 000-20zm0 18a8 8 0 110-16 8 8 0 010 16z"/>
            <path d="M12 6v6l4 2"/>
          </svg>
          Normal
        `;
        document.getElementById("modeIndicator").textContent = "Bajo Estrés";
        document.getElementById("lowStressNote").style.display = "block";
      }

      renderTasks();
    });
  </script>
</body>
</html>